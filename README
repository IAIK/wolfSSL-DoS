CVE-2015-6925: DoS attack on wolfSSL DTLS server and DoS amplification
======================================================================

This is a simple example demonstrating CVE-2015-6925 [1, 2]. It sends
ClientHello messages with spoofed sender addresses but valid cookies to a
wolfSSL based DTLS server. All wolfSSL versions supporting DTLS before 3.6.8 are
affected by this vulnerability.

 * attack.c: Sends the spoofed ClientHello messages.
 * dtls-server.c: Very simple DTLS server (slightly modified version of [3])
 * target.c: Listens and prints the number of bytes received.

Assume the following scenario:

  * dtls-server runs on a machine with IP 192.168.0.1.
  * target runs on a machine with IP 192.168.0.2.
  * attack runs on any other machine.

Now run

  $ attack -i $interface --server 192.168.0.1 --target 192.168.0.2

where $interface is the network interface the packets should be sent on. If
there is a gateway involved or attack can not detect the MAC address of the
server, specify --server-hwaddr.

attack needs superuser privileges to run.

target should print

  Received 48 bytes. (for the HelloVerifyRequest message)

and about seven times (based on the default timeouts)

  Received 95 bytes. (for the ServerHello message)
  Received 3281 bytes. (for the Certificate message)
  Received 482 bytes. (for the ServerKeyExchange message)
  Received 25 bytes. (for the ServerHelloDone message)

The numbers depend on the choice of algorithms and may vary with the choice of
algorithms and packet fragmentation of the handshake packets.

[1] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6925
[2] https://www.wolfssl.com/wolfSSL/Blog/Entries/2015/9/17_Two_Vulnerabilities_Recently_Found,_An_Attack_on_RSA_using_CRT_and_DoS_Vulnerability_With_DTLS.html
[3] https://github.com/wolfSSL/wolfssl-examples/blob/master/dtls/server-dtls.c
